

<div class="dialog-container">
    <div class="dialog">
        <div class="dialog-title">
            <h2>Import from .csv</h2>
        </div>
        @if (showBody)
        {

        
    <form class="dialog-body">
        <label> First Line Header</label>
        <input type="checkbox" />
        <br />
        <br />



        <div style="overflow-x:auto" class="dialog-body">
            <!-- Create a table for the info of the file  -->
            <table>
                <tr>
                    <th>Name</th>
                    <th>Longtitude</th>
                    <th>Latitude</th>
                    <th>Supply</th>
                    <th>Demand</th>
                </tr>
                <tr>
                    @for (int i = 0; i < contants.Length; i++)
                    {
                        <td>@contants[i]</td>
                    }
                </tr>
            </table>

            <table>
            </table>
        </div>

        <!-- for loops to create the 1-17 buttons  -->
        @for (int i = 1; i < 18; i++)
        {<button>@i</button>}Name
        <br />
        @for (int i = 1; i < 18; i++)
        {<button>@i</button>}Latitude
        <br />
        @for (int i = 1; i < 18; i++)
        {<button>@i</button>}Longitude
        <br />
        @for (int i = 1; i < 18; i++)
        {<button>@i</button>}Demand[palettes]
        <br />
        @for (int i = 1; i < 18; i++)
        {<button>@i</button>}Supply[palettes]
    </form>
        }
    <div class="dialog-buttons">
        <button @onclick="@Close" class="btn btn-secondary mr-auto">Close</button>

        <InputFile OnChange="HandleFileSelected" />
        @if (showImportButton)
        {
            <button @onclick="@ImportFile" class="btn btn-success ml-auto">OK, Import</button>
        }
    </div>
    </div>
</div>






@code {



    IFileListEntry file;
    [Parameter] public List<Node> Nodes { get; set; }
    
 
    bool showBody = false; //for diplaying the body of the import page

    bool showImportButton = false; // for displaying the import button

    //the size is arbitrary. 
    string[] contants = new string[4];


    void HandleFileSelected(IFileListEntry[] files)
    {
        file = files.FirstOrDefault();
        showImportButton = true;
        // Do something with the files, e.g., read them
    }
    async Task ImportFile()
    {


        //read the selected file. 
        using (var reader = new System.IO.StreamReader(file.Data))
        {
            while (await reader.ReadLineAsync() != null)
            {

                contants = reader.ReadLineAsync().Result.Split(',');
            }
        }

        //Create a new Node with read information and add to the nodelist. 
        Node x = new Node();
        x.State.Name = contants[0];
        x.State.Location_x = Int32.Parse(contants[1]);
        x.State.Location_y = Int32.Parse(contants[2]);
        x.State.Demand = contants[3];
        x.State.Supply = contants[4];
        importNodes(x);

        //show the Body of the imported info. 
        showBody = true;
    }

    void importNodes(Node x)
    {
        Nodes.Add(x);

    }

    [Parameter] public EventCallback OnChange { get; set; }

    [Parameter] public EventCallback Close { get; set; }
}
